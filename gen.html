<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi Penyiraman Media Tanam</title>
    <link rel="icon" type="image/x-icon" href="asset/favicon.png">
    <link rel="stylesheet" href="asset/npm/bootstrap/5.3.0-alpha1/css/bootstrap.min.css">
    <link rel="stylesheet" href="asset/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="asset/font-googleapis/css2.css">
    <script type="text/javascript" src="asset/scripts/jquery-3.6.0.min.js"></script> 
    <link rel="stylesheet" href="asset/style-gen.css">
</head>
<body class="material-typography">
    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loadingSpinner">
        <div class="spinner"></div>
    </div>

    <!-- Snackbar -->
    <div class="snackbar" id="snackbar"></div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <div class="toast-header">
            <h6 class="toast-title" id="toastTitle"></h6>
            <button class="toast-close" id="toastClose">&times;</button>
        </div>
        <p id="toastMessage"></p>
    </div>

    <!-- Custom Alert -->
    <div class="custom-alert" id="customAlert">
        <div class="alert-header">
            <h5 id="alertTitle"></h5>
            <button class="alert-close" id="alertClose">&times;</button>
        </div>
        <p id="alertMessage"></p>
        <div>
            <button id="alertConfirm" class="btn btn-primary">OK</button>
        </div>
    </div>

    <!-- Custom Prompt -->
    <div class="custom-prompt" id="customPrompt">
        <div class="prompt-header">
            <h5 id="promptTitle"></h5>
            <button class="prompt-close" id="promptClose">&times;</button>
        </div>
        <p id="promptMessage"></p>
        <input type="text" class="form-control" id="promptInput">
        <div class="text-right mt-3">
            <button id="promptConfirm" class="btn btn-primary">OK</button>
            <button id="promptCancel" class="btn btn-outline-primary">Batal</button>
        </div>
    </div>

    <!-- Custom Confirm -->
    <div class="custom-confirm" id="customConfirm">
        <div class="confirm-header">
            <h5 id="confirmTitle"></h5>
            <button class="confirm-close" id="confirmClose">&times;</button>
        </div>
        <p id="confirmMessage"></p>
        <div>
            <button id="confirmYes" class="btn btn-primary">Ya</button>
            <button id="confirmNo" class="btn btn-outline-primary">Tidak</button>
        </div>
    </div>

    <!-- Modal untuk pesan -->
    <div class="custom-modal material-modal" id="messageModal">
        <div class="modal-content">
            <div class="modal-header">
                <h5 id="modalTitle" class="modal-title"></h5>
                <button class="close-btn" id="modalClose">&times;</button>
            </div>
            <div class="modal-body">
                <p id="modalMessage"></p>
            </div>
            <div class="modal-footer">
                <button id="modalCloseBtn" class="btn btn-primary">Tutup</button>
            </div>
        </div>
    </div>

    <!-- Modal untuk simpanan -->
    <div class="custom-modal material-modal" id="savedModal">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Komposisi Tersimpan</h5>
                <button class="close-btn" id="savedModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Tambahan tombol untuk export semua komposisi -->
                <div class="export-import-all-container">
                    <button id="export-all-compositions" class="btn btn-outline-primary">
                        <i class="fas fa-download me-1"></i>Export Semua
                    </button>
                </div>
                <div class="saved-compositions" id="savedCompositionsList">
                    <!-- Daftar simpanan akan diisi dengan JavaScript -->
                </div>
            </div>
            <div class="modal-footer">
                <button id="savedModalCloseBtn" class="btn btn-primary">Tutup</button>
            </div>
        </div>
    </div>

    <!-- Modal untuk import komposisi -->
    <div class="custom-modal material-modal" id="importCompositionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Import Komposisi Media Tanam</h5>
                <button class="close-btn" id="importCompositionModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label">Pilih file JSON komposisi media tanam:</label>
                    <input type="file" id="importCompositionFile" class="form-control" accept=".json">
                </div>
            </div>
            <div class="modal-footer">
                <button id="importCompositionConfirm" class="btn btn-primary">Import</button>
                <button id="importCompositionModalCloseBtn" class="btn btn-outline-primary">Batal</button>
            </div>
        </div>
    </div>

    <!-- Modal untuk menyimpan komposisi dengan deskripsi -->
    <div class="custom-modal material-modal" id="saveCompositionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Simpan Komposisi</h5>
                <button class="close-btn" id="saveCompositionModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label">Nama Komposisi:</label>
                    <input type="text" id="saveCompositionName" class="form-control" placeholder="Masukkan nama komposisi">
                </div>
                <div class="mb-3">
                    <label class="form-label">Deskripsi Komposisi:</label>
                    <textarea id="saveCompositionDescription" class="form-control" rows="3" placeholder="Masukkan deskripsi untuk komposisi ini"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveCompositionConfirm" class="btn btn-primary">Simpan</button>
                <button id="saveCompositionModalCloseBtn" class="btn btn-outline-primary">Batal</button>
            </div>
        </div>
    </div>

    <div class="header header-gradient text-center mb-5">
        <div class="container">
            <h1><i class="fas fa-leaf me-2"></i>Simulasi Penyiraman Media Tanam</h1>
            <p class="lead">Analisis porositas, retensi air, dan drainase untuk media tanam optimal</p>
        </div>
        <div class="plant-decoration">
            <svg viewBox="0 0 100 100">
                <path d="M50,10 C60,20 65,35 60,50 C55,65 45,70 50,80 C55,90 65,85 70,75 C75,65 80,50 75,35 C70,20 60,15 50,10 Z" />
                <path d="M50,80 L50,95" stroke-width="3" />
                <path d="M40,60 L30,70" stroke-width="2" />
                <path d="M60,60 L70,70" stroke-width="2" />
            </svg>
        </div>
    </div>

    <!-- Animasi tanaman -->
    <div class="plant-animation">
        <svg class="plant-svg" viewBox="0 0 120 180">
            <!-- Pot (diam) -->
            <g class="pot-group">
                <!-- Badan Pot -->
                <path class="pot-body" d="M40 160 L80 160 L85 120 L35 120 Z" fill="#8B4513" stroke="#5D4037" stroke-width="2"/>
                <!-- Rim Pot -->
                <path class="pot-rim" d="M35 120 L85 120 L88 115 L32 115 Z" fill="#A0522D"/>
                <!-- Base Pot -->
                <path class="pot-base" d="M45 160 L75 160 L78 165 L42 165 Z" fill="#5D4037"/>
            </g>
            
            <!-- Tanaman (bergerak) -->
            <g class="plant-group">
                <!-- Batang utama -->
                <path class="stem stem-main" d="M60 120 C62 100 58 80 60 60 C62 40 65 20 60 10" fill="none" stroke="#2e7d32" stroke-width="3" stroke-linecap="round"/>
                
                <!-- Batang cabang 1 -->
                <path class="stem stem-branch-1" d="M60 80 C45 75 40 65 35 55" fill="none" stroke="#2e7d32" stroke-width="2" stroke-linecap="round"/>
                
                <!-- Batang cabang 2 -->
                <path class="stem stem-branch-2" d="M60 90 C75 85 80 75 85 65" fill="none" stroke="#2e7d32" stroke-width="2" stroke-linecap="round"/>
                
                <!-- Daun 1 (kiri atas) -->
                <path class="leaf leaf-1" d="M35 55 C25 45 20 35 25 25 C30 15 40 20 45 30 C50 40 45 50 35 55 Z" fill="#4caf50" stroke="#388e3c" stroke-width="1"/>
                
                <!-- Daun 2 (kanan atas) -->
                <path class="leaf leaf-2" d="M85 65 C95 55 100 45 95 35 C90 25 80 30 75 40 C70 50 75 60 85 65 Z" fill="#4caf50" stroke="#388e3c" stroke-width="1"/>
                
                <!-- Daun 3 (tengah) -->
                <path class="leaf leaf-3" d="M60 10 C45 0 35 -5 40 -15 C45 -25 55 -20 60 -10 C65 0 75 5 60 10 Z" fill="#4caf50" stroke="#388e3c" stroke-width="1"/>
                
                <!-- Daun 4 (kiri bawah) -->
                <path class="leaf leaf-4" d="M45 75 C30 65 25 55 30 45 C35 35 40 40 45 50 C50 60 60 65 45 75 Z" fill="#4caf50" stroke="#388e3c" stroke-width="1"/>
                
                <!-- Daun 5 (kanan bawah) -->
                <path class="leaf leaf-5" d="M75 85 C90 75 95 65 90 55 C85 45 80 50 75 60 C70 70 60 75 75 85 Z" fill="#4caf50" stroke="#388e3c" stroke-width="1"/>
            </g>
        </svg>
    </div>

    <div class="container">
        <!-- Card BAHAN BAKU TERSEDIA -->
        <div class="card elevation-2 card-hover mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-seedling me-2"></i>BAHAN BAKU TERSEDIA</h5>
            </div>
            <div class="card-body">
                <div class="dropdown-wrapper">
                    <div class="material-dropdown">
                        <button class="dropdown-toggle" type="button" id="materialDropdownButton">
                            <span id="selected-material-text">Pilih Bahan Baku</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="dropdown-menu" id="materialDropdownMenu">
                            <!-- Daftar bahan akan diisi dengan JavaScript -->
                        </div>
                    </div>
                    <button id="add-selected-material" class="add-material-btn" title="Tambah ke Komposisi">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Panel Komposisi dan Simulasi -->
        <div class="card elevation-2 card-hover">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="fas fa-list-ul me-2"></i>KOMPOSISI MEDIA TANAM</h5>
                <div class="composition-actions">
                    <div class="tooltip-container">
                        <button id="export-composition" class="btn btn-sm btn-outline-light me-1">
                            <i class="fas fa-download"></i>
                        </button>
                        <!-- <span class="tooltip-text">Export Komposisi</span> -->
                    </div>
                    <div class="tooltip-container">
                        <button id="import-composition" class="btn btn-sm btn-outline-light">
                            <i class="fas fa-upload"></i>
                        </button>
                        <!-- <span class="tooltip-text">Import Komposisi</span> -->
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div id="composition-list">
                    <p class="text-center text-muted p-4">Tambahkan bahan dari dropdown di atas untuk memulai</p>
                </div>
                <div class="divider"></div>
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <strong>Total Bagian: <span id="total-percentage">0</span></strong>
                    </div>
                    <div class="action-buttons">
                        <div class="tooltip-container">
                            <button id="save-composition" class="btn btn-sm btn-outline-primary me-1">
                                <i class="fas fa-save"></i>
                            </button>
                            <span class="tooltip-text">Simpan Komposisi</span>
                        </div>
                        <div class="tooltip-container">
                            <button id="view-saved" class="btn btn-sm btn-outline-primary me-1">
                                <i class="fas fa-folder"></i>
                            </button>
                            <span class="tooltip-text">Lihat Simpanan</span>
                        </div>
                        <div class="tooltip-container">
                            <button id="reset-composition" class="btn btn-sm btn-outline-primary me-1">
                                <i class="fas fa-redo"></i>
                            </button>
                            <span class="tooltip-text">Reset Komposisi</span>
                        </div>
                        <div class="tooltip-container">
                            <button id="reset-portions" class="btn btn-sm btn-outline-primary">
                                <i class="fas fa-eraser"></i>
                            </button>
                            <span class="tooltip-text">Clear</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Card PENGATURAN POT -->
        <div class="card elevation-2 card-hover mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-cogs me-2"></i>PENGATURAN POT</h5>
            </div>
            <div class="card-body">
                <div class="pot-settings-row">
                    <div class="pot-settings-group">
                        <label class="form-label">Diameter Pot (cm)</label>
                        <input type="number" class="form-control" id="pot-diameter" value="9.5" min="1" step="0.1">
                    </div>
                    <div class="pot-settings-group">
                        <label class="form-label">Tinggi Pot (cm)</label>
                        <input type="number" class="form-control" id="pot-height" value="9.5" min="1" step="0.1">
                    </div>
                    <div class="pot-settings-group">
                        <label class="form-label">Media dalam Pot (%)</label>
                        <input type="number" class="form-control" id="media-percentage" value="95" min="1" max="100" step="0.1">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Card SIMULASI PENYIRAMAN -->
        <div class="card elevation-2 mt-4 card-hover simulation-card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-tint me-2"></i>SIMULASI PENYIRAMAN</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="watering-controls mb-4">
                            <div class="watering-control-group">
                                <label class="form-label">Volume Air</label>
                                <div class="water-input-group">
                                    <input type="number" class="form-control" id="water-volume-input" min="0" max="5000" value="1000" step="0.1">
                                    <span>mL</span>
                                </div>
                            </div>
                            
                            <div class="watering-control-group">
                                <label class="form-label">Durasi Penyiraman</label>
                                <div class="water-input-group">
                                    <input type="number" class="form-control duration-input" id="watering-duration-input" value="20" min="1" max="600" step="0.1">
                                    <span>detik</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button id="run-simulation" class="btn btn-primary btn-material">
                                <i class="fas fa-play me-1"></i>Jalankan Simulasi
                            </button>
                            <button id="reset-simulation" class="btn btn-outline-primary btn-material">
                                <i class="fas fa-undo me-1"></i>Reset Simulasi
                            </button>
                            <button id="export-simulation" class="btn btn-outline-primary btn-material">
                                <i class="fas fa-download me-1"></i>Export Hasil Simulasi
                            </button>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <!-- Pot dengan animasi yang ditingkatkan -->
                        <div class="pot-container-enhanced">
                            <div class="pot-enhanced">
                                <div class="watering-animation-enhanced" id="watering-animation-enhanced"></div>
                                <div class="pot-rim-enhanced"></div>
                                <div class="pot-body-enhanced">
                                    <div class="media-composition-enhanced" id="media-composition-enhanced"></div>
                                    <div class="water-level-enhanced" id="water-level-enhanced" style="height: 0%">
                                        <div class="water-waves"></div>
                                    </div>
                                    <div class="drainage-animation-enhanced" id="drainage-animation-enhanced"></div>
                                </div>
                                <div class="pot-base-enhanced"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="card result-card elevation-1" id="simulation-result" style="display: none;">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Hasil Simulasi</h5>
                            </div>
                            <div class="card-body">                                
                                <div class="result-item">
                                    <i class="fas fa-tint"></i>
                                    <div>
                                        <label>Volume Air yang Digunakan:</label>
                                        <h5 id="water-volume">0 mL</h5>
                                    </div>
                                </div>
                                
                                <div class="result-item">
                                    <i class="fas fa-clock"></i>
                                    <div>
                                        <label>Durasi Penyiraman:</label>
                                        <h5 id="watering-duration">0 detik</h5>
                                    </div>
                                </div>
                                
                                <div class="result-item">
                                    <i class="fas fa-flask"></i>
                                    <div>
                                        <label>Volume Pot:</label>
                                        <h5 id="pot-volume">0 mL</h5>
                                    </div>
                                </div>
                                
                                <div class="result-item">
                                    <i class="fas fa-box"></i>
                                    <div>
                                        <label>Volume Media:</label>
                                        <h5 id="media-volume">0 mL</h5>
                                    </div>
                                </div>
                                
                                <div class="result-item">
                                    <i class="fas fa-water"></i>
                                    <div>
                                        <label>Air yang Tertahan di Media:</label>
                                        <h5 id="retained-water-value">0 mL</h5>
                                    </div>
                                </div>
                                
                                <div class="result-item">
                                    <i class="fas fa-absorb"></i>
                                    <div>
                                        <label>Air yang Terserap Media:</label>
                                        <h5 id="absorbed-water-percentage">0%</h5>
                                    </div>
                                </div>
                                
                                <div class="result-item">
                                    <i class="fas fa-faucet"></i>
                                    <div>
                                        <label>Air yang Mengalir Keluar:</label>
                                        <h5 id="drained-water-value">0 mL</h5>
                                    </div>
                                </div>

                                <!-- Tambahan: Persentase Kebasahan Media -->
                                <div class="result-item">
                                    <i class="fas fa-percentage"></i>
                                    <div>
                                        <label>Kebasahan Media:</label>
                                        <h5 id="media-wetness">0%</h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card media-properties-card elevation-1" id="media-properties" style="display: none;">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="fas fa-vial me-2"></i>Sifat Media Campuran (Rata-rata Tertimbang)</h5>
                            </div>
                            <div class="card-body">
                                <div class="media-property">
                                    <div class="icon-tooltip">
                                        <i class="fas fa-tint"></i>
                                        <span class="tooltip-text">Retensi Air (%) - Kemampuan media menahan air</span>
                                    </div>
                                    <span>Retensi Media: <span id="avg-retention">0%</span></span>
                                </div>
                                <div class="media-property">
                                    <div class="icon-tooltip">
                                        <i class="fas fa-water"></i>
                                        <span class="tooltip-text">Drainase (%) - Kemampuan media mengalirkan air</span>
                                    </div>
                                    <span>Drainase Media: <span id="avg-drainage">0%</span></span>
                                </div>
                                <div class="media-property">
                                    <div class="icon-tooltip">
                                        <i class="fas fa-wind"></i>
                                        <span class="tooltip-text">Porositas (%) - Ruang udara dalam media</span>
                                    </div>
                                    <span>Porositas Media: <span id="avg-porosity">0%</span></span>
                                </div>
                                <div class="media-property">
                                    <div class="icon-tooltip">
                                        <i class="fas fa-flask"></i>
                                        <span class="tooltip-text">Tingkat keasaman (pH)</span>
                                    </div>
                                    <span>pH Media: <span id="avg-ph">0</span></span>
                                </div>
                                <div class="media-property">
                                    <div class="icon-tooltip">
                                        <i class="fas fa-exchange-alt"></i>
                                        <span class="tooltip-text">Kapasitas Tukar Kation (CEC)</span>
                                    </div>
                                    <span>CEC Media: <span id="avg-cec">0 meq/100g</span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card analysis-card elevation-1 mt-4" id="analysis-card" style="display: none;">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-robot me-2"></i>Analisis Media & Rekomendasi</h5>
                    </div>
                    <div class="card-body">
                        <div id="analysis-content">
                            <!-- Analisis akan diisi dengan JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer text-center mt-5">
        <div class="container">
            <p class="mb-0">Aplikasi Simulasi Penyiraman Media Tanam &copy; 2025</p>
        </div>
    </div>

    <script type="text/javascript" src="asset/scripts/data-gen.js"></script>
    <script type="text/javascript" src="asset/scripts/simulator-gen.js"></script>
</body>
</html>